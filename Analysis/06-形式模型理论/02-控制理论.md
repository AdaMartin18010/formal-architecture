# 02-控制理论

## 目录

1. [1.0 线性系统控制](#10-线性系统控制)
2. [2.0 非线性控制](#20-非线性控制)
3. [3.0 自适应控制](#30-自适应控制)
4. [4.0 鲁棒控制](#40-鲁棒控制)
5. [5.0 最优控制](#50-最优控制)
6. [6.0 软件控制](#60-软件控制)

## 1.0 线性系统控制

### 1.1 线性系统模型

**定义 1.1.1 (线性时不变系统)**
线性时不变系统是一个五元组 $\mathcal{S} = (X, U, Y, A, B, C, D)$，其中：

- $X$ 是状态空间
- $U$ 是控制输入空间
- $Y$ 是输出空间
- $A: X \to X$ 是状态转移矩阵
- $B: U \to X$ 是输入矩阵
- $C: X \to Y$ 是输出矩阵
- $D: U \to Y$ 是直接传递矩阵

系统方程为：
$$\dot{x}(t) = Ax(t) + Bu(t)$$
$$y(t) = Cx(t) + Du(t)$$

**定义 1.1.2 (可控性)**
系统 $\mathcal{S}$ 可控，如果可控性矩阵 $[B, AB, \ldots, A^{n-1}B]$ 满秩。

**定义 1.1.3 (可观性)**
系统 $\mathcal{S}$ 可观，如果可观性矩阵 $[C^T, A^TC^T, \ldots, (A^T)^{n-1}C^T]^T$ 满秩。

**定理 1.1.1 (可控性判据)**
系统可控当且仅当 $\text{rank}[B, AB, \ldots, A^{n-1}B] = n$。

### 1.2 状态反馈控制

**定义 1.2.1 (状态反馈)**
状态反馈控制器定义为：
$$u(t) = -Kx(t)$$

其中 $K$ 是反馈增益矩阵。

**定义 1.2.2 (闭环系统)**
闭环系统方程为：
$$\dot{x}(t) = (A - BK)x(t)$$

**定理 1.2.1 (极点配置)**
如果系统可控，则可以通过状态反馈任意配置闭环极点。

**证明**：
对于可控系统，存在变换矩阵 $T$ 使得：
$$\tilde{A} = T^{-1}AT = \begin{bmatrix}
0 & 1 & 0 & \cdots & 0 \\
0 & 0 & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
-a_0 & -a_1 & -a_2 & \cdots & -a_{n-1}
\end{bmatrix}$$

选择 $\tilde{K} = [k_0, k_1, \ldots, k_{n-1}]$ 使得：
$$\tilde{A} - \tilde{B}\tilde{K} = \begin{bmatrix}
0 & 1 & 0 & \cdots & 0 \\
0 & 0 & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
-p_0 & -p_1 & -p_2 & \cdots & -p_{n-1}
\end{bmatrix}$$

则 $K = \tilde{K}T^{-1}$ 实现期望的极点配置。

### 1.3 观测器设计

**定义 1.3.1 (全维观测器)**
全维观测器定义为：
$$\dot{\hat{x}}(t) = A\hat{x}(t) + Bu(t) + L(y(t) - C\hat{x}(t))$$

其中 $L$ 是观测器增益矩阵。

**定义 1.3.2 (观测误差)**
观测误差定义为：
$$e(t) = x(t) - \hat{x}(t)$$

**定理 1.3.1 (观测器稳定性)**
如果系统可观，则可以通过选择 $L$ 使观测误差指数收敛到零。

**证明**：
观测误差动态方程为：
$$\dot{e}(t) = (A - LC)e(t)$$

如果系统可观，则 $(A^T, C^T)$ 可控，因此可以通过选择 $L$ 使 $A - LC$ 的特征值具有负实部。

## 2.0 非线性控制

### 2.1 非线性系统模型

**定义 2.1.1 (非线性系统)**
非线性系统定义为：
$$\dot{x}(t) = f(x(t), u(t), t)$$
$$y(t) = h(x(t), u(t), t)$$

其中 $f$ 和 $h$ 是非线性函数。

**定义 2.1.2 (李雅普诺夫稳定性)**
平衡点 $x_e$ 是稳定的，如果对于任意 $\varepsilon > 0$，存在 $\delta > 0$ 使得：
$$\|x(0) - x_e\| < \delta \Rightarrow \|x(t) - x_e\| < \varepsilon, \quad \forall t \geq 0$$

**定义 2.1.3 (渐近稳定性)**
平衡点 $x_e$ 是渐近稳定的，如果它是稳定的且：
$$\lim_{t \to \infty} x(t) = x_e$$

**定理 2.1.1 (李雅普诺夫定理)**
如果存在正定函数 $V(x)$ 使得 $\dot{V}(x) < 0$，则平衡点是渐近稳定的。

### 2.2 反馈线性化

**定义 2.2.1 (相对度)**
系统的相对度定义为满足 $L_g L_f^{r-1} h(x) \neq 0$ 的最小整数 $r$。

**定义 2.2.2 (反馈线性化)**
反馈线性化通过坐标变换和状态反馈将非线性系统转换为线性系统。

**定理 2.2.1 (反馈线性化条件)**
系统可以通过反馈线性化转换为线性系统，当且仅当相对度等于系统阶数。

**证明**：
如果相对度 $r = n$，则存在坐标变换：
$$z = \begin{bmatrix}
h(x) \\
L_f h(x) \\
\vdots \\
L_f^{n-1} h(x)
\end{bmatrix}$$

和反馈控制：
$$u = \frac{1}{L_g L_f^{n-1} h(x)}(-L_f^n h(x) + v)$$

使得系统变为：
$$\dot{z}_i = z_{i+1}, \quad i = 1, \ldots, n-1$$
$$\dot{z}_n = v$$

### 2.3 滑模控制

**定义 2.3.1 (滑模面)**
滑模面定义为：
$$s(x) = c^T x = 0$$

其中 $c$ 是设计参数。

**定义 2.3.2 (滑模控制律)**
滑模控制律定义为：
$$u = u_{eq} + u_{sw}$$

其中：
- $u_{eq}$ 是等效控制
- $u_{sw}$ 是切换控制

**定理 2.3.1 (滑模稳定性)**
如果滑模面设计使得 $\dot{s} = -\eta \text{sgn}(s)$，则系统在有限时间内到达滑模面。

## 3.0 自适应控制

### 3.1 参数自适应

**定义 3.1.1 (参数自适应系统)**
参数自适应系统定义为：
$$\dot{x}(t) = f(x(t), \theta(t), u(t))$$
$$\dot{\theta}(t) = \Gamma \phi(x(t)) e(t)$$

其中：
- $\theta(t)$ 是参数估计
- $\Gamma$ 是自适应增益
- $\phi(x)$ 是回归向量
- $e(t)$ 是跟踪误差

**定义 3.1.2 (自适应律)**
自适应律定义为：
$$\dot{\hat{\theta}}(t) = \Gamma \phi(x(t)) e(t)$$

**定理 3.1.1 (自适应稳定性)**
如果回归向量 $\phi(x)$ 持续激励，则参数估计收敛到真值。

### 3.2 模型参考自适应控制

**定义 3.2.1 (参考模型)**
参考模型定义为：
$$\dot{x}_m(t) = A_m x_m(t) + B_m r(t)$$

其中 $r(t)$ 是参考输入。

**定义 3.2.2 (跟踪误差)**
跟踪误差定义为：
$$e(t) = x_m(t) - x(t)$$

**定理 3.2.1 (MRAC稳定性)**
如果参考模型稳定且系统满足匹配条件，则跟踪误差收敛到零。

### 3.3 神经网络控制

**定义 3.3.1 (神经网络)**
神经网络定义为：
$$y = W^T \sigma(V^T x + b_1) + b_2$$

其中：
- $W, V$ 是权重矩阵
- $b_1, b_2$ 是偏置向量
- $\sigma$ 是激活函数

**定义 3.3.2 (神经网络控制)**
神经网络控制器定义为：
$$u = W^T \sigma(V^T x + b_1) + b_2$$

**定理 3.3.1 (万能逼近)**
对于任意连续函数 $f$ 和 $\varepsilon > 0$，存在神经网络使得：
$$\|f(x) - y(x)\| < \varepsilon$$

## 4.0 鲁棒控制

### 4.1 不确定性建模

**定义 4.1.1 (参数不确定性)**
参数不确定性定义为：
$$A = A_0 + \Delta A, \quad \|\Delta A\| \leq \delta$$

**定义 4.1.2 (结构不确定性)**
结构不确定性定义为：
$$\Delta(s) = W_1(s) \Delta(s) W_2(s), \quad \|\Delta(s)\|_\infty \leq 1$$

**定理 4.1.1 (小增益定理)**
如果 $\|G(s)\|_\infty \|H(s)\|_\infty < 1$，则反馈系统 $G(s)(I + H(s))^{-1}$ 稳定。

### 4.2 H∞控制

**定义 4.2.1 (H∞范数)**
传递函数 $G(s)$ 的H∞范数定义为：
$$\|G(s)\|_\infty = \sup_{\omega} \sigma_{\max}(G(j\omega))$$

**定义 4.2.2 (H∞控制问题)**
H∞控制问题是寻找控制器 $K(s)$ 使得：
$$\|T_{zw}(s)\|_\infty < \gamma$$

其中 $T_{zw}(s)$ 是从干扰 $w$ 到输出 $z$ 的闭环传递函数。

**定理 4.2.1 (H∞控制器存在性)**
H∞控制器存在当且仅当两个Riccati方程有正定解。

### 4.3 μ综合

**定义 4.3.1 (结构奇异值)**
结构奇异值定义为：
$$\mu(M) = \frac{1}{\min\{\|\Delta\| \mid \det(I - M\Delta) = 0\}}$$

**定义 4.3.2 (μ综合)**
μ综合是寻找控制器使得：
$$\mu(T_{zw}(s)) < 1$$

**定理 4.3.1 (μ综合算法)**
μ综合可以通过D-K迭代算法求解。

## 5.0 最优控制

### 5.1 线性二次型控制

**定义 5.1.1 (LQR问题)**
线性二次型调节器(LQR)问题是寻找控制律 $u(t) = -Kx(t)$ 最小化：
$$J = \int_0^\infty (x^T(t)Qx(t) + u^T(t)Ru(t)) dt$$

其中 $Q \geq 0$ 和 $R > 0$ 是权重矩阵。

**定义 5.1.2 (代数Riccati方程)**
代数Riccati方程为：
$$A^TP + PA - PBR^{-1}B^TP + Q = 0$$

**定理 5.1.1 (LQR最优性)**
最优控制律为 $u^*(t) = -R^{-1}B^TPx(t)$，其中 $P$ 是Riccati方程的正定解。

### 5.2 动态规划

**定义 5.2.1 (值函数)**
值函数定义为：
$$V(x, t) = \min_{u} \int_t^T L(x(\tau), u(\tau), \tau) d\tau$$

**定义 5.2.2 (哈密顿-雅可比方程)**
哈密顿-雅可比方程为：
$$\frac{\partial V}{\partial t} + \min_u \{L(x, u, t) + \frac{\partial V}{\partial x} f(x, u, t)\} = 0$$

**定理 5.2.1 (最优性原理)**
最优控制满足：
$$u^*(t) = \arg\min_u \{L(x, u, t) + \frac{\partial V}{\partial x} f(x, u, t)\}$$

### 5.3 模型预测控制

**定义 5.3.1 (预测模型)**
预测模型定义为：
$$x(k+1) = Ax(k) + Bu(k)$$

**定义 5.3.2 (MPC问题)**
模型预测控制(MPC)问题是求解：
$$\min_{u(k), \ldots, u(k+N-1)} \sum_{i=0}^{N-1} (x^T(k+i)Qx(k+i) + u^T(k+i)Ru(k+i))$$

**定理 5.3.1 (MPC稳定性)**
如果终端权重 $P$ 满足Lyapunov方程，则MPC闭环系统稳定。

## 6.0 软件控制

### 6.1 软件系统建模

**定义 6.1.1 (软件系统)**
软件系统是一个四元组 $\mathcal{SS} = (S, A, T, O)$，其中：

- $S$ 是状态集合
- $A$ 是动作集合
- $T: S \times A \to S$ 是转移函数
- $O: S \to Y$ 是观察函数

**定义 6.1.2 (软件控制)**
软件控制是通过控制输入调节软件系统行为的过程。

**定理 6.1.1 (软件可控性)**
软件系统可控当且仅当从任意状态可达目标状态。

### 6.2 自适应软件控制

**定义 6.2.1 (自适应软件)**
自适应软件能够根据环境变化调整自身行为。

**定义 6.2.2 (学习算法)**
学习算法用于更新软件控制策略：
$$\pi_{k+1} = \pi_k + \alpha \nabla J(\pi_k)$$

**定理 6.2.1 (收敛性)**
在适当条件下，学习算法收敛到最优策略。

### 6.3 分布式控制

**定义 6.3.1 (分布式系统)**
分布式系统由多个子系统组成，通过通信协调行为。

**定义 6.3.2 (一致性控制)**
一致性控制确保所有子系统达到相同状态：
$$\lim_{t \to \infty} \|x_i(t) - x_j(t)\| = 0$$

**定理 6.3.1 (一致性条件)**
如果通信图连通，则一致性控制能够实现。

## 总结

本控制理论建立了完整的控制系统形式化框架，包括：

1. **线性控制**：状态反馈、观测器设计、极点配置
2. **非线性控制**：反馈线性化、滑模控制、李雅普诺夫稳定性
3. **自适应控制**：参数自适应、模型参考、神经网络控制
4. **鲁棒控制**：H∞控制、μ综合、不确定性处理
5. **最优控制**：LQR、动态规划、模型预测控制
6. **软件控制**：软件建模、自适应控制、分布式控制

该理论为控制系统的设计、分析和实现提供了坚实的数学基础，确保系统的稳定性、性能和鲁棒性。

---

**相关链接**：
- [Petri网理论](../01-Petri网理论.md)
- [时态逻辑理论](../03-时态逻辑理论.md)
- [分布式系统理论](../04-分布式系统理论.md) 