# 04-复杂性理论

## 目录

1. [1.0 时间复杂性理论](#10-时间复杂性理论)
2. [2.0 空间复杂性理论](#20-空间复杂性理论)
3. [3.0 NP完全性理论](#30-np完全性理论)
4. [4.0 随机复杂性](#40-随机复杂性)
5. [5.0 量子复杂性](#50-量子复杂性)
6. [6.0 近似算法](#60-近似算法)

## 1.0 时间复杂性理论

### 1.1 时间复杂度定义

**定义 1.1.1 (时间复杂度)**
算法 $A$ 的时间复杂度 $T_A(n)$ 定义为算法在输入规模 $n$ 下的最大执行步数。

**定义 1.1.2 (大O记号)**
函数 $f(n) = O(g(n))$ 当且仅当存在常数 $c > 0$ 和 $n_0 > 0$ 使得：
$$\forall n \geq n_0, \quad f(n) \leq c \cdot g(n)$$

**定义 1.1.3 (大Ω记号)**
函数 $f(n) = \Omega(g(n))$ 当且仅当存在常数 $c > 0$ 和 $n_0 > 0$ 使得：
$$\forall n \geq n_0, \quad f(n) \geq c \cdot g(n)$$

**定义 1.1.4 (大Θ记号)**
函数 $f(n) = \Theta(g(n))$ 当且仅当 $f(n) = O(g(n))$ 且 $f(n) = \Omega(g(n))$。

**定理 1.1.1 (多项式时间)**
多项式时间算法的时间复杂度为 $O(n^k)$，其中 $k$ 是常数。

### 1.2 复杂度类

**定义 1.2.1 (P类)**
P类是多项式时间可解的问题集合：
$$\text{P} = \{L \mid \exists \text{TM } M, \text{TM在多项式时间内判定} L\}$$

**定义 1.2.2 (NP类)**
NP类是非确定性多项式时间可验证的问题集合：
$$\text{NP} = \{L \mid \exists \text{TM } M, \forall x \in L, \exists w, M(x,w) = 1 \text{且} |w| = \text{poly}(|x|)\}$$

**定义 1.2.3 (EXP类)**
EXP类是指数时间可解的问题集合：
$$\text{EXP} = \{L \mid \exists \text{TM } M, \text{TM在} 2^{n^{O(1)}} \text{时间内判定} L\}$$

**定理 1.2.1 (复杂度类包含关系)**
$$\text{P} \subseteq \text{NP} \subseteq \text{EXP}$$

### 1.3 归约理论

**定义 1.3.1 (多项式时间归约)**
语言 $A$ 多项式时间归约到语言 $B$，记为 $A \leq_P B$，如果存在多项式时间可计算的函数 $f$ 使得：
$$\forall x, \quad x \in A \Leftrightarrow f(x) \in B$$

**定义 1.3.2 (NP难问题)**
问题 $L$ 是NP难的，如果对于任意 $A \in \text{NP}$，$A \leq_P L$。

**定义 1.3.3 (NP完全问题)**
问题 $L$ 是NP完全的，如果 $L \in \text{NP}$ 且 $L$ 是NP难的。

**定理 1.3.1 (归约传递性)**
如果 $A \leq_P B$ 且 $B \leq_P C$，则 $A \leq_P C$。

## 2.0 空间复杂性理论

### 2.1 空间复杂度定义

**定义 2.1.1 (空间复杂度)**
算法 $A$ 的空间复杂度 $S_A(n)$ 定义为算法在输入规模 $n$ 下的最大工作空间使用量。

**定义 2.1.2 (对数空间)**
对数空间算法使用 $O(\log n)$ 个工作空间。

**定义 2.1.3 (多项式空间)**
多项式空间算法使用 $O(n^k)$ 个工作空间，其中 $k$ 是常数。

**定理 2.1.1 (空间层次定理)**
对于任意空间可构造函数 $s_1(n) = o(s_2(n))$，存在语言 $L$ 在空间 $s_2(n)$ 中可判定，但在空间 $s_1(n)$ 中不可判定。

### 2.2 空间复杂度类

**定义 2.2.1 (L类)**
L类是对数空间可解的问题集合：
$$\text{L} = \{L \mid \exists \text{TM } M, \text{TM在对数空间内判定} L\}$$

**定义 2.2.2 (PSPACE类)**
PSPACE类是多项式空间可解的问题集合：
$$\text{PSPACE} = \{L \mid \exists \text{TM } M, \text{TM在多项式空间内判定} L\}$$

**定义 2.2.3 (EXPSPACE类)**
EXPSPACE类是指数空间可解的问题集合：
$$\text{EXPSPACE} = \{L \mid \exists \text{TM } M, \text{TM在指数空间内判定} L\}$$

**定理 2.2.1 (空间复杂度类包含关系)**
$$\text{L} \subseteq \text{PSPACE} \subseteq \text{EXPSPACE}$$

### 2.3 空间与时间关系

**定理 2.3.1 (空间时间关系)**
对于任意图灵机 $M$，如果 $M$ 在空间 $s(n)$ 内运行，则 $M$ 在时间 $2^{O(s(n))}$ 内运行。

**证明**：
如果图灵机使用空间 $s(n)$，则配置数为 $2^{O(s(n))}$，因此时间不超过 $2^{O(s(n))}$。

**定理 2.3.2 (萨维奇定理)**
$$\text{NPSPACE} = \text{PSPACE}$$

**证明**：
使用配置图方法，可以在多项式空间内模拟非确定性图灵机。

## 3.0 NP完全性理论

### 3.1 经典NP完全问题

**定义 3.1.1 (SAT问题)**
布尔可满足性问题(SAT)是判断给定布尔公式是否存在满足赋值。

**定义 3.1.2 (3-SAT问题)**
3-SAT问题是SAT的特殊情况，其中每个子句最多包含3个文字。

**定义 3.1.3 (CLIQUE问题)**
团问题是判断给定图中是否存在大小为 $k$ 的完全子图。

**定理 3.1.1 (库克-列文定理)**
SAT问题是NP完全的。

**证明**：

1. SAT ∈ NP：非确定性算法猜测赋值并验证
2. SAT是NP难的：对于任意NP问题，构造布尔公式模拟图灵机计算

### 3.2 NP完全性证明

**定理 3.2.1 (3-SAT的NP完全性)**
3-SAT问题是NP完全的。

**证明**：
通过将SAT归约到3-SAT：

1. 将每个子句转换为等价的3-CNF形式
2. 使用额外变量保持等价性

**定理 3.2.2 (CLIQUE的NP完全性)**
CLIQUE问题是NP完全的。

**证明**：
通过将3-SAT归约到CLIQUE：

1. 为每个子句创建顶点
2. 连接不冲突的顶点
3. 大小为 $k$ 的团对应满足赋值

### 3.3 其他NP完全问题

**定义 3.3.1 (哈密顿回路问题)**
哈密顿回路问题是判断给定图中是否存在经过所有顶点恰好一次的回路。

**定义 3.3.2 (旅行商问题)**
旅行商问题是寻找访问所有城市恰好一次且总距离最小的回路。

**定义 3.3.3 (背包问题)**
背包问题是选择物品使得总价值最大且总重量不超过限制。

**定理 3.3.1 (哈密顿回路的NP完全性)**
哈密顿回路问题是NP完全的。

**定理 3.3.2 (旅行商问题的NP完全性)**
旅行商问题是NP完全的。

## 4.0 随机复杂性

### 4.1 随机算法

**定义 4.1.1 (随机算法)**
随机算法是使用随机数生成器的算法。

**定义 4.1.2 (拉斯维加斯算法)**
拉斯维加斯算法总是返回正确答案，但运行时间可能变化。

**定义 4.1.3 (蒙特卡洛算法)**
蒙特卡洛算法可能返回错误答案，但错误概率可控。

**定理 4.1.1 (随机快速排序)**
随机快速排序的期望时间复杂度为 $O(n \log n)$。

### 4.2 随机复杂度类

**定义 4.2.1 (RP类)**
RP类是随机多项式时间可解的问题集合：
$$\text{RP} = \{L \mid \exists \text{随机TM } M, \forall x \in L, \Pr[M(x) = 1] \geq 1/2\}$$

**定义 4.2.2 (BPP类)**
BPP类是有界错误概率多项式时间可解的问题集合：
$$\text{BPP} = \{L \mid \exists \text{随机TM } M, \forall x, \Pr[M(x) = \chi_L(x)] \geq 2/3\}$$

**定义 4.2.3 (ZPP类)**
ZPP类是零错误概率多项式时间可解的问题集合：
$$\text{ZPP} = \text{RP} \cap \text{co-RP}$$

**定理 4.2.1 (随机复杂度类关系)**
$$\text{P} \subseteq \text{ZPP} \subseteq \text{RP} \subseteq \text{NP}$$

### 4.3 随机归约

**定义 4.3.1 (随机归约)**
语言 $A$ 随机归约到语言 $B$，如果存在随机多项式时间算法 $R$ 使得：
$$\forall x, \quad x \in A \Leftrightarrow \Pr[R(x) \in B] \geq 2/3$$

**定理 4.3.1 (随机归约性质)**
随机归约保持NP完全性。

## 5.0 量子复杂性

### 5.1 量子计算模型

**定义 5.1.1 (量子图灵机)**
量子图灵机是经典图灵机的量子推广，使用量子叠加和纠缠。

**定义 5.1.2 (量子电路)**
量子电路是由量子门组成的计算模型。

**定义 5.1.3 (量子傅里叶变换)**
量子傅里叶变换是量子计算中的基本操作：
$$|j\rangle \mapsto \frac{1}{\sqrt{N}} \sum_{k=0}^{N-1} e^{2\pi i jk/N} |k\rangle$$

**定理 5.1.1 (量子傅里叶变换)**
量子傅里叶变换可以在 $O(\log^2 N)$ 时间内实现。

### 5.2 量子复杂度类

**定义 5.2.1 (BQP类)**
BQP类是有界错误量子多项式时间可解的问题集合：
$$\text{BQP} = \{L \mid \exists \text{量子TM } M, \forall x, \Pr[M(x) = \chi_L(x)] \geq 2/3\}$$

**定义 5.2.2 (QMA类)**
QMA类是量子梅林-亚瑟类：
$$\text{QMA} = \{L \mid \exists \text{量子TM } M, \forall x \in L, \exists |\psi\rangle, \Pr[M(x,|\psi\rangle) = 1] \geq 2/3\}$$

**定理 5.2.1 (量子复杂度类关系)**
$$\text{P} \subseteq \text{BPP} \subseteq \text{BQP} \subseteq \text{PSPACE}$$

### 5.3 量子算法

**定理 5.3.1 (肖尔算法)**
肖尔算法可以在量子计算机上在多项式时间内分解大整数。

**定理 5.3.2 (格罗弗算法)**
格罗弗算法可以在 $O(\sqrt{N})$ 时间内搜索未排序数据库。

**定理 5.3.3 (量子模拟)**
量子计算机可以高效模拟量子系统。

## 6.0 近似算法

### 6.1 近似算法定义

**定义 6.1.1 (近似算法)**
近似算法是求解优化问题的算法，返回接近最优解的答案。

**定义 6.1.2 (近似比)**
算法 $A$ 的近似比定义为：
$$\alpha = \max\{\frac{\text{OPT}(I)}{A(I)}, \frac{A(I)}{\text{OPT}(I)}\}$$

其中 $\text{OPT}(I)$ 是最优解，$A(I)$ 是算法输出。

**定义 6.1.3 (PTAS)**
多项式时间近似方案(PTAS)是对于任意 $\varepsilon > 0$，存在多项式时间算法返回 $(1+\varepsilon)$-近似解。

### 6.2 经典近似算法

**定理 6.2.1 (贪心算法)**
对于某些问题，贪心算法可以提供常数近似比。

**定理 6.2.2 (线性规划松弛)**
线性规划松弛可以提供良好的近似解。

**定理 6.2.3 (随机化近似)**
随机化算法可以提高近似质量。

### 6.3 近似难度

**定义 6.3.1 (APX类)**
APX类是存在常数近似算法的问题集合。

**定义 6.3.2 (PTAS类)**
PTAS类是存在PTAS的问题集合。

**定理 6.3.1 (近似难度)**
某些NP完全问题不存在常数近似算法，除非P=NP。

**定理 6.3.2 (不可近似性)**
某些问题不存在 $(1+\varepsilon)$-近似算法，除非P=NP。

## 总结

本复杂性理论建立了完整的计算复杂性理论框架，包括：

1. **时间复杂性**：时间复杂度定义、复杂度类、归约理论
2. **空间复杂性**：空间复杂度定义、空间复杂度类、空间时间关系
3. **NP完全性**：经典NP完全问题、NP完全性证明、归约技术
4. **随机复杂性**：随机算法、随机复杂度类、随机归约
5. **量子复杂性**：量子计算模型、量子复杂度类、量子算法
6. **近似算法**：近似算法定义、经典算法、近似难度

该理论为算法设计和问题分类提供了坚实的数学基础，揭示了计算的本质限制和可能性边界。

---

**相关链接**：

- [形式语言基础](../01-形式语言基础.md)
- [自动机理论](../02-自动机理论.md)
- [计算理论](../03-计算理论.md)
