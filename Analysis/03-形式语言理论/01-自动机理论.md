# 01-自动机理论：计算模型的形式化基础

## 目录

1. [1.0 自动机基本概念](#10-自动机基本概念)
2. [2.0 有限自动机](#20-有限自动机)
3. [3.0 下推自动机](#30-下推自动机)
4. [4.0 图灵机](#40-图灵机)
5. [5.0 线性有界自动机](#50-线性有界自动机)
6. [6.0 自动机等价性](#60-自动机等价性)
7. [7.0 自动机最小化](#70-自动机最小化)
8. [8.0 软件自动机](#80-软件自动机)
9. [9.0 应用与实现](#90-应用与实现)
10. [10.0 形式化证明](#100-形式化证明)

## 1.0 自动机基本概念

### 1.1 自动机定义

**定义 1.1.1 (自动机)**
自动机是一个五元组 $M = (Q, \Sigma, \delta, q_0, F)$，其中：

- $Q$ 是有限状态集合
- $\Sigma$ 是有限输入字母表
- $\delta: Q \times \Sigma \to Q$ 是转移函数
- $q_0 \in Q$ 是初始状态
- $F \subseteq Q$ 是接受状态集合

**定义 1.1.2 (配置)**
自动机的配置是一个二元组 $(q, w)$，其中：

- $q \in Q$ 是当前状态
- $w \in \Sigma^*$ 是剩余输入串

**定义 1.1.3 (转移关系)**
转移关系 $\vdash_M$ 定义为：
$$(q, aw) \vdash_M (q', w) \text{ 当且仅当 } \delta(q, a) = q'$$

### 1.2 自动机分类

**定义 1.2.1 (自动机层次)**
根据计算能力，自动机分为：

1. **有限自动机 (FA)**：识别正则语言
2. **下推自动机 (PDA)**：识别上下文无关语言
3. **线性有界自动机 (LBA)**：识别上下文敏感语言
4. **图灵机 (TM)**：识别递归可枚举语言

**定理 1.2.1 (乔姆斯基层次)**
自动机的计算能力形成严格的层次结构：
$$\text{FA} \subset \text{PDA} \subset \text{LBA} \subset \text{TM}$$

## 2.0 有限自动机

### 2.1 确定性有限自动机 (DFA)

**定义 2.1.1 (DFA)**
确定性有限自动机是一个五元组 $M = (Q, \Sigma, \delta, q_0, F)$，其中：

- $\delta: Q \times \Sigma \to Q$ 是确定性转移函数
- 对于任意 $q \in Q$ 和 $a \in \Sigma$，$\delta(q, a)$ 唯一确定

**定义 2.1.2 (DFA接受语言)**
DFA $M$ 接受的语言定义为：
$$L(M) = \{w \in \Sigma^* \mid (q_0, w) \vdash_M^* (q_f, \epsilon), q_f \in F\}$$

**定理 2.1.1 (DFA等价性)**
对于任意正则语言 $L$，存在DFA $M$ 使得 $L(M) = L$。

### 2.2 非确定性有限自动机 (NFA)

**定义 2.2.1 (NFA)**
非确定性有限自动机是一个五元组 $M = (Q, \Sigma, \delta, q_0, F)$，其中：

- $\delta: Q \times \Sigma \to 2^Q$ 是非确定性转移函数
- 对于任意 $q \in Q$ 和 $a \in \Sigma$，$\delta(q, a)$ 是状态集合

**定义 2.2.2 (NFA转移关系)**
NFA的转移关系定义为：
$$(q, aw) \vdash_M (q', w) \text{ 当且仅当 } q' \in \delta(q, a)$$

**定理 2.2.1 (NFA到DFA转换)**
对于任意NFA $M$，存在DFA $M'$ 使得 $L(M) = L(M')$。

**证明**：
使用子集构造法，DFA的状态是NFA状态集合的幂集。

### 2.3 ε-非确定性有限自动机 (ε-NFA)

**定义 2.3.1 (ε-NFA)**
ε-NFA是一个五元组 $M = (Q, \Sigma, \delta, q_0, F)$，其中：

- $\delta: Q \times (\Sigma \cup \{\epsilon\}) \to 2^Q$ 是转移函数
- 允许ε转移：$\delta(q, \epsilon)$ 可能非空

**定义 2.3.2 (ε闭包)**
状态 $q$ 的ε闭包定义为：
$$\text{CLOSURE}(q) = \{p \in Q \mid q \vdash_M^* p \text{ 通过ε转移}\}$$

**定理 2.3.1 (ε-NFA等价性)**
ε-NFA与DFA等价，即对于任意ε-NFA，存在等价的DFA。

## 3.0 下推自动机

### 3.1 下推自动机定义

**定义 3.1.1 (PDA)**
下推自动机是一个七元组 $M = (Q, \Sigma, \Gamma, \delta, q_0, Z_0, F)$，其中：

- $Q$ 是有限状态集合
- $\Sigma$ 是输入字母表
- $\Gamma$ 是栈字母表
- $\delta: Q \times (\Sigma \cup \{\epsilon\}) \times \Gamma \to 2^{Q \times \Gamma^*}$ 是转移函数
- $q_0 \in Q$ 是初始状态
- $Z_0 \in \Gamma$ 是初始栈符号
- $F \subseteq Q$ 是接受状态集合

**定义 3.1.2 (PDA配置)**
PDA的配置是一个三元组 $(q, w, \gamma)$，其中：

- $q \in Q$ 是当前状态
- $w \in \Sigma^*$ 是剩余输入
- $\gamma \in \Gamma^*$ 是栈内容

**定义 3.1.3 (PDA转移)**
PDA的转移关系定义为：
$$(q, aw, Z\gamma) \vdash_M (p, w, \alpha\gamma) \text{ 当且仅当 } (p, \alpha) \in \delta(q, a, Z)$$

### 3.2 PDA接受模式

**定义 3.2.1 (终态接受)**
PDA通过终态接受语言：
$$L_F(M) = \{w \in \Sigma^* \mid (q_0, w, Z_0) \vdash_M^* (q_f, \epsilon, \gamma), q_f \in F\}$$

**定义 3.2.2 (空栈接受)**
PDA通过空栈接受语言：
$$L_N(M) = \{w \in \Sigma^* \mid (q_0, w, Z_0) \vdash_M^* (q, \epsilon, \epsilon)\}$$

**定理 3.2.1 (接受模式等价性)**
对于任意PDA $M$，存在PDA $M'$ 使得 $L_F(M) = L_N(M')$。

### 3.3 确定性下推自动机

**定义 3.3.1 (DPDA)**
确定性下推自动机是PDA，满足：

1. 对于任意 $q \in Q, a \in \Sigma, Z \in \Gamma$，$|\delta(q, a, Z)| \leq 1$
2. 对于任意 $q \in Q, Z \in \Gamma$，如果 $|\delta(q, \epsilon, Z)| > 0$，则对于所有 $a \in \Sigma$，$|\delta(q, a, Z)| = 0$

**定理 3.3.1 (DPDA限制)**
DPDA只能识别确定性上下文无关语言，不能识别所有上下文无关语言。

## 4.0 图灵机

### 4.1 图灵机定义

**定义 4.1.1 (图灵机)**
图灵机是一个七元组 $M = (Q, \Sigma, \Gamma, \delta, q_0, B, F)$，其中：

- $Q$ 是有限状态集合
- $\Sigma$ 是输入字母表
- $\Gamma$ 是带字母表，$\Sigma \subseteq \Gamma$
- $\delta: Q \times \Gamma \to Q \times \Gamma \times \{L, R\}$ 是转移函数
- $q_0 \in Q$ 是初始状态
- $B \in \Gamma \setminus \Sigma$ 是空白符号
- $F \subseteq Q$ 是接受状态集合

**定义 4.1.2 (图灵机配置)**
图灵机的配置是一个三元组 $(q, \alpha, i)$，其中：

- $q \in Q$ 是当前状态
- $\alpha \in \Gamma^*$ 是带内容
- $i \in \mathbb{N}$ 是读写头位置

**定义 4.1.3 (图灵机转移)**
图灵机的转移关系定义为：
$$(q, \alpha, i) \vdash_M (p, \beta, j)$$
其中 $\delta(q, \alpha_i) = (p, b, D)$，$\beta$ 是将 $\alpha_i$ 替换为 $b$ 的结果，$j = i + 1$ 如果 $D = R$，$j = i - 1$ 如果 $D = L$。

### 4.2 图灵机变体

**定义 4.2.1 (多带图灵机)**
多带图灵机有多个带，每个带都有自己的读写头。

**定理 4.2.1 (多带图灵机等价性)**
多带图灵机与单带图灵机等价。

**定义 4.2.2 (非确定性图灵机)**
非确定性图灵机的转移函数为：
$$\delta: Q \times \Gamma \to 2^{Q \times \Gamma \times \{L, R\}}$$

**定理 4.2.2 (非确定性图灵机等价性)**
非确定性图灵机与确定性图灵机等价。

### 4.3 通用图灵机

**定义 4.3.1 (通用图灵机)**
通用图灵机 $U$ 可以模拟任意图灵机 $M$：
$$U(\langle M \rangle, w) = M(w)$$

其中 $\langle M \rangle$ 是图灵机 $M$ 的编码。

**定理 4.3.1 (通用图灵机存在性)**
存在通用图灵机。

## 5.0 线性有界自动机

### 5.1 LBA定义

**定义 5.1.1 (线性有界自动机)**
线性有界自动机是一个七元组 $M = (Q, \Sigma, \Gamma, \delta, q_0, B, F)$，其中：

- 除了读写头不能移出输入范围外，其他与图灵机相同
- 输入串用特殊符号标记边界

**定义 5.1.2 (LBA接受语言)**
LBA接受的语言定义为：
$$L(M) = \{w \in \Sigma^* \mid (q_0, \#w\#, 0) \vdash_M^* (q_f, \alpha, i), q_f \in F\}$$

其中 $\#$ 是边界符号。

### 5.2 LBA性质

**定理 5.2.1 (LBA语言类)**
LBA识别的语言类是上下文敏感语言。

**定理 5.2.2 (LBA确定性)**
确定性LBA与非确定性LBA不等价。

## 6.0 自动机等价性

### 6.1 等价性定义

**定义 6.1.1 (自动机等价)**
两个自动机 $M_1$ 和 $M_2$ 等价，记为 $M_1 \equiv M_2$，当且仅当：
$$L(M_1) = L(M_2)$$

**定义 6.1.2 (自动机同构)**
两个自动机 $M_1$ 和 $M_2$ 同构，如果存在双射 $f: Q_1 \to Q_2$ 使得：

1. $f(q_{01}) = q_{02}$
2. $f(F_1) = F_2$
3. $\delta_2(f(q), a) = f(\delta_1(q, a))$

### 6.2 等价性证明

**定理 6.2.1 (DFA最小化)**
对于任意DFA $M$，存在唯一的（在同构意义下）最小DFA $M'$ 使得 $M \equiv M'$。

**证明**：
使用等价类构造，将等价状态合并。

**定理 6.2.2 (自动机层次)**
自动机的计算能力形成严格层次：
$$\text{DFA} \subset \text{PDA} \subset \text{LBA} \subset \text{TM}$$

## 7.0 自动机最小化

### 7.1 状态等价性

**定义 7.1.1 (状态等价)**
两个状态 $p, q \in Q$ 等价，记为 $p \equiv q$，当且仅当：
$$\forall w \in \Sigma^*, \delta^*(p, w) \in F \Leftrightarrow \delta^*(q, w) \in F$$

**定义 7.1.2 (k等价)**
两个状态 $p, q$ 是k等价的，如果它们对于长度不超过k的所有串行为相同。

### 7.2 最小化算法

**算法 7.2.1 (DFA最小化)**

1. 移除不可达状态
2. 计算等价类
3. 合并等价状态
4. 更新转移函数

**定理 7.2.1 (最小化正确性)**
最小化算法产生的DFA与原DFA等价且状态数最少。

## 8.0 软件自动机

### 8.1 软件状态机

**定义 8.1.1 (软件自动机)**
软件自动机是一个六元组 $\mathcal{SA} = (S, E, T, s_0, F, G)$，其中：

- $S$ 是状态集合
- $E$ 是事件集合
- $T$ 是转换函数
- $s_0$ 是初始状态
- $F$ 是最终状态集合
- $G$ 是守卫条件集合

**定义 8.1.2 (软件状态)**
软件状态是一个三元组 $(v, p, r)$，其中：

- $v$ 是变量值
- $p$ 是程序计数器
- $r$ 是资源状态

### 8.2 并发自动机

**定义 8.2.1 (并发自动机)**
并发自动机是多个自动机的组合：
$$\mathcal{CA} = \mathcal{SA}_1 \parallel \mathcal{SA}_2 \parallel \cdots \parallel \mathcal{SA}_n$$

**定义 8.2.2 (并发配置)**
并发配置是各组件状态的组合：
$$(s_1, s_2, \ldots, s_n)$$

### 8.3 实时自动机

**定义 8.3.1 (实时自动机)**
实时自动机在软件自动机基础上增加时间约束：
$$\mathcal{RTA} = (S, E, T, s_0, F, G, C)$$

其中 $C$ 是时钟约束集合。

## 9.0 应用与实现

### 9.1 编译器应用

**定义 9.1.1 (词法分析器)**
词法分析器是DFA的应用，识别语言的词法单元。

**算法 9.1.1 (词法分析)**

```rust
struct Lexer {
    dfa: DFA,
    input: String,
    position: usize,
}

impl Lexer {
    fn next_token(&mut self) -> Option<Token> {
        let mut current_state = self.dfa.initial_state();
        let mut start_pos = self.position;
        
        while let Some(c) = self.input.chars().nth(self.position) {
            if let Some(next_state) = self.dfa.transition(current_state, c) {
                current_state = next_state;
                self.position += 1;
            } else {
                break;
            }
        }
        
        if self.dfa.is_accepting(current_state) {
            let lexeme = &self.input[start_pos..self.position];
            Some(Token::new(lexeme, current_state))
        } else {
            None
        }
    }
}
```

### 9.2 协议验证

**定义 9.2.1 (协议自动机)**
协议自动机用于验证通信协议的正确性。

**定义 9.2.2 (协议属性)**
协议属性包括：

- 安全性：不会进入错误状态
- 活性：最终会达到目标状态
- 公平性：每个进程都有机会执行

### 9.3 模型检查

**定义 9.3.1 (模型检查)**
模型检查是验证系统是否满足时序逻辑公式的过程。

**算法 9.3.1 (CTL模型检查)**

```rust
fn model_check(system: &System, formula: &CTLFormula) -> bool {
    match formula {
        CTLFormula::Atomic(prop) => system.satisfies(prop),
        CTLFormula::Not(phi) => !model_check(system, phi),
        CTLFormula::And(phi, psi) => {
            model_check(system, phi) && model_check(system, psi)
        }
        CTLFormula::EX(phi) => {
            system.states().any(|s| {
                system.successors(s).any(|t| model_check_at(system, t, phi))
            })
        }
        // ... 其他操作符
    }
}
```

## 10.0 形式化证明

### 10.1 自动机等价性证明

**定理 10.1.1 (NFA到DFA转换正确性)**
对于任意NFA $M$，子集构造法产生的DFA $M'$ 满足 $L(M) = L(M')$。

**证明**：
通过归纳法证明，对于任意输入串 $w$，$M$ 接受 $w$ 当且仅当 $M'$ 接受 $w$。

### 10.2 最小化算法证明

**定理 10.2.1 (最小化算法正确性)**
最小化算法产生的DFA与原DFA等价。

**证明**：

1. 等价性：通过等价类定义证明
2. 最小性：通过反证法证明不存在更小的等价DFA

### 10.3 停机问题证明

**定理 10.3.1 (停机问题不可判定)**
停机问题是不可判定的，即不存在算法可以判定任意图灵机是否停机。

**证明**：
使用对角化方法，构造矛盾。

## 总结

本文建立了自动机理论的形式化体系，包括：

1. **基本概念**：自动机定义、分类、配置
2. **有限自动机**：DFA、NFA、ε-NFA
3. **下推自动机**：PDA、DPDA、接受模式
4. **图灵机**：基本图灵机、变体、通用图灵机
5. **线性有界自动机**：LBA定义和性质
6. **等价性理论**：自动机等价、最小化
7. **软件应用**：软件自动机、并发、实时
8. **实际应用**：编译器、协议验证、模型检查

该理论体系为计算理论、编译原理、软件验证等领域提供了坚实的理论基础。
