# 01-范畴论基础：统一数学结构的形式化理论

## 目录

1. [1.0 范畴基本概念](#10-范畴基本概念)
2. [2.0 函子理论](#20-函子理论)
3. [3.0 自然变换](#30-自然变换)
4. [4.0 极限与余极限](#40-极限与余极限)
5. [5.0 伴随函子](#50-伴随函子)
6. [6.0 幺半范畴](#60-幺半范畴)
7. [7.0 闭范畴](#70-闭范畴)
8. [8.0 软件范畴](#80-软件范畴)
9. [9.0 计算范畴](#90-计算范畴)
10. [10.0 形式化证明](#100-形式化证明)

## 1.0 范畴基本概念

### 1.1 范畴定义

**定义 1.1.1 (范畴)**
范畴 $\mathcal{C}$ 是一个四元组 $(\text{Ob}(\mathcal{C}), \text{Mor}(\mathcal{C}), \circ, \text{id})$，其中：

- $\text{Ob}(\mathcal{C})$ 是对象集合
- $\text{Mor}(\mathcal{C})$ 是态射集合
- $\circ$ 是态射复合运算
- $\text{id}$ 是恒等态射

**公理 1.1.1 (范畴公理)**:

1. **结合律**：$(f \circ g) \circ h = f \circ (g \circ h)$
2. **单位律**：$f \circ \text{id}_A = f = \text{id}_B \circ f$
3. **定义域**：对于态射 $f: A \to B$，$\text{dom}(f) = A$，$\text{cod}(f) = B$

**定义 1.1.2 (小范畴与大范畴)**
- 小范畴：对象和态射都是集合
- 大范畴：对象和态射可能是真类

### 1.2 范畴例子

**定义 1.2.1 (集合范畴 Set)**
集合范畴 $\mathbf{Set}$：
- 对象：所有集合
- 态射：集合间的函数
- 复合：函数复合
- 恒等：恒等函数

**定义 1.2.2 (群范畴 Grp)**
群范畴 $\mathbf{Grp}$：
- 对象：所有群
- 态射：群同态
- 复合：同态复合
- 恒等：恒等同态

**定义 1.2.3 (拓扑空间范畴 Top)**
拓扑空间范畴 $\mathbf{Top}$：
- 对象：所有拓扑空间
- 态射：连续映射
- 复合：映射复合
- 恒等：恒等映射

### 1.3 范畴构造

**定义 1.3.1 (对偶范畴)**
范畴 $\mathcal{C}$ 的对偶范畴 $\mathcal{C}^{op}$：
- 对象：与 $\mathcal{C}$ 相同
- 态射：$\text{Mor}_{\mathcal{C}^{op}}(A, B) = \text{Mor}_{\mathcal{C}}(B, A)$
- 复合：$f \circ^{op} g = g \circ f$

**定义 1.3.2 (积范畴)**
范畴 $\mathcal{C}$ 和 $\mathcal{D}$ 的积范畴 $\mathcal{C} \times \mathcal{D}$：
- 对象：$(A, B)$ 其中 $A \in \text{Ob}(\mathcal{C}), B \in \text{Ob}(\mathcal{D})$
- 态射：$(f, g): (A, B) \to (A', B')$ 其中 $f: A \to A', g: B \to B'$
- 复合：$(f, g) \circ (f', g') = (f \circ f', g \circ g')$

## 2.0 函子理论

### 2.1 函子定义

**定义 2.1.1 (协变函子)**
协变函子 $F: \mathcal{C} \to \mathcal{D}$ 包含：

1. 对象映射：$F: \text{Ob}(\mathcal{C}) \to \text{Ob}(\mathcal{D})$
2. 态射映射：$F: \text{Mor}(\mathcal{C}) \to \text{Mor}(\mathcal{D})$

满足：
- $F(f: A \to B) = F(f): F(A) \to F(B)$
- $F(f \circ g) = F(f) \circ F(g)$
- $F(\text{id}_A) = \text{id}_{F(A)}$

**定义 2.1.2 (反变函子)**
反变函子 $F: \mathcal{C} \to \mathcal{D}$ 满足：
- $F(f: A \to B) = F(f): F(B) \to F(A)$
- $F(f \circ g) = F(g) \circ F(f)$
- $F(\text{id}_A) = \text{id}_{F(A)}$

### 2.2 函子例子

**定义 2.2.1 (遗忘函子)**
遗忘函子 $U: \mathbf{Grp} \to \mathbf{Set}$：
- 将群映射到其底层集合
- 将群同态映射到集合函数

**定义 2.2.2 (自由函子)**
自由函子 $F: \mathbf{Set} \to \mathbf{Grp}$：
- 将集合映射到其生成的自由群
- 将函数映射到群同态

**定义 2.2.3 (幂集函子)**
幂集函子 $P: \mathbf{Set} \to \mathbf{Set}$：
- $P(A) = 2^A$（$A$ 的幂集）
- $P(f)(X) = f(X)$（$X \subseteq A$）

### 2.3 函子性质

**定义 2.3.1 (忠实函子)**
函子 $F: \mathcal{C} \to \mathcal{D}$ 是忠实的，如果对于任意 $A, B \in \text{Ob}(\mathcal{C})$，映射：
$$\text{Mor}_{\mathcal{C}}(A, B) \to \text{Mor}_{\mathcal{D}}(F(A), F(B))$$
是单射。

**定义 2.3.2 (完全函子)**
函子 $F: \mathcal{C} \to \mathcal{D}$ 是完全的，如果上述映射是满射。

**定义 2.3.3 (本质满函子)**
函子 $F: \mathcal{C} \to \mathcal{D}$ 是本质满的，如果对于任意 $D \in \text{Ob}(\mathcal{D})$，存在 $C \in \text{Ob}(\mathcal{C})$ 使得 $F(C) \cong D$。

## 3.0 自然变换

### 3.1 自然变换定义

**定义 3.1.1 (自然变换)**
自然变换 $\alpha: F \Rightarrow G$ 是两个函子 $F, G: \mathcal{C} \to \mathcal{D}$ 之间的变换，包含：

对于每个对象 $A \in \text{Ob}(\mathcal{C})$，态射 $\alpha_A: F(A) \to G(A)$，满足自然性条件：
对于任意态射 $f: A \to B$，有：
$$G(f) \circ \alpha_A = \alpha_B \circ F(f)$$

**定义 3.1.2 (自然同构)**
自然变换 $\alpha: F \Rightarrow G$ 是自然同构，如果每个 $\alpha_A$ 都是同构。

### 3.2 自然变换例子

**定义 3.2.1 (恒等自然变换)**
恒等自然变换 $1_F: F \Rightarrow F$ 定义为 $1_{F,A} = \text{id}_{F(A)}$。

**定义 3.2.2 (自然变换复合)**
自然变换 $\alpha: F \Rightarrow G$ 和 $\beta: G \Rightarrow H$ 的复合 $\beta \circ \alpha: F \Rightarrow H$ 定义为：
$$(\beta \circ \alpha)_A = \beta_A \circ \alpha_A$$

### 3.3 函子范畴

**定义 3.3.1 (函子范畴)**
函子范畴 $[\mathcal{C}, \mathcal{D}]$：
- 对象：函子 $F: \mathcal{C} \to \mathcal{D}$
- 态射：自然变换 $\alpha: F \Rightarrow G$

**定理 3.3.1 (函子范畴性质)**
函子范畴 $[\mathcal{C}, \mathcal{D}]$ 是一个范畴。

## 4.0 极限与余极限

### 4.1 锥与余锥

**定义 4.1.1 (锥)**
对于函子 $F: \mathcal{J} \to \mathcal{C}$，锥 $(C, \psi)$ 包含：
- 对象 $C \in \text{Ob}(\mathcal{C})$
- 自然变换 $\psi: \Delta_C \Rightarrow F$

其中 $\Delta_C$ 是常函子，将 $\mathcal{J}$ 的所有对象映射到 $C$。

**定义 4.1.2 (余锥)**
对于函子 $F: \mathcal{J} \to \mathcal{C}$，余锥 $(C, \psi)$ 包含：
- 对象 $C \in \text{Ob}(\mathcal{C})$
- 自然变换 $\psi: F \Rightarrow \Delta_C$

### 4.2 极限定义

**定义 4.2.1 (极限)**
函子 $F: \mathcal{J} \to \mathcal{C}$ 的极限是锥 $(L, \phi)$，满足：
对于任意锥 $(C, \psi)$，存在唯一的态射 $u: C \to L$ 使得：
$$\phi_j \circ u = \psi_j \text{ 对于所有 } j \in \text{Ob}(\mathcal{J})$$

**定义 4.2.2 (余极限)**
函子 $F: \mathcal{J} \to \mathcal{C}$ 的余极限是余锥 $(L, \phi)$，满足：
对于任意余锥 $(C, \psi)$，存在唯一的态射 $u: L \to C$ 使得：
$$u \circ \phi_j = \psi_j \text{ 对于所有 } j \in \text{Ob}(\mathcal{J})$$

### 4.3 特殊极限

**定义 4.3.1 (积)**
离散范畴 $\mathcal{J}$ 上的函子 $F$ 的极限称为积：
$$\prod_{j \in J} F(j)$$

**定义 4.3.2 (等化子)**
平行态射 $f, g: A \to B$ 的等化子是极限：
$$\text{Eq}(f, g) = \{x \in A \mid f(x) = g(x)\}$$

**定义 4.3.3 (拉回)**
态射 $f: A \to C$ 和 $g: B \to C$ 的拉回是极限：
$$A \times_C B$$

## 5.0 伴随函子

### 5.1 伴随定义

**定义 5.1.1 (伴随函子)**
函子 $F: \mathcal{C} \to \mathcal{D}$ 和 $G: \mathcal{D} \to \mathcal{C}$ 构成伴随对 $(F \dashv G)$，如果存在自然同构：
$$\text{Mor}_{\mathcal{D}}(F(A), B) \cong \text{Mor}_{\mathcal{C}}(A, G(B))$$

**定义 5.1.2 (单位与余单位)**
伴随 $(F \dashv G)$ 的单位 $\eta: 1_{\mathcal{C}} \Rightarrow GF$ 和余单位 $\epsilon: FG \Rightarrow 1_{\mathcal{D}}$ 满足：
$$\epsilon_{F(A)} \circ F(\eta_A) = \text{id}_{F(A)}$$
$$G(\epsilon_B) \circ \eta_{G(B)} = \text{id}_{G(B)}$$

### 5.2 伴随例子

**定义 5.2.1 (自由-遗忘伴随)**
自由函子 $F: \mathbf{Set} \to \mathbf{Grp}$ 和遗忘函子 $U: \mathbf{Grp} \to \mathbf{Set}$ 构成伴随：
$$F \dashv U$$

**定义 5.2.2 (积-对角伴随)**
积函子 $\times: \mathbf{Set} \times \mathbf{Set} \to \mathbf{Set}$ 和对角函子 $\Delta: \mathbf{Set} \to \mathbf{Set} \times \mathbf{Set}$ 构成伴随：
$$\times \dashv \Delta$$

### 5.3 伴随性质

**定理 5.3.1 (伴随保持极限)**
左伴随保持余极限，右伴随保持极限。

**定理 5.3.2 (伴随唯一性)**
如果 $F \dashv G$ 和 $F \dashv G'$，则 $G \cong G'$。

## 6.0 幺半范畴

### 6.1 幺半范畴定义

**定义 6.1.1 (幺半范畴)**
幺半范畴 $(\mathcal{C}, \otimes, I, \alpha, \lambda, \rho)$ 包含：

- 范畴 $\mathcal{C}$
- 双函子 $\otimes: \mathcal{C} \times \mathcal{C} \to \mathcal{C}$
- 单位对象 $I \in \text{Ob}(\mathcal{C})$
- 结合子 $\alpha: (A \otimes B) \otimes C \cong A \otimes (B \otimes C)$
- 左单位子 $\lambda: I \otimes A \cong A$
- 右单位子 $\rho: A \otimes I \cong A$

满足五边形公理和三角形公理。

### 6.2 幺半函子

**定义 6.2.1 (强幺半函子)**
强幺半函子 $F: \mathcal{C} \to \mathcal{D}$ 包含：
- 函子 $F$
- 自然同构 $\mu: F(A) \otimes F(B) \cong F(A \otimes B)$
- 同构 $\eta: I_{\mathcal{D}} \cong F(I_{\mathcal{C}})$

满足幺半函子公理。

### 6.3 幺半范畴例子

**定义 6.3.1 (集合幺半范畴)**
$(\mathbf{Set}, \times, \{*\}, \alpha, \lambda, \rho)$ 是幺半范畴，其中 $\times$ 是笛卡尔积。

**定义 6.3.2 (向量空间幺半范畴)**
$(\mathbf{Vect}_k, \otimes, k, \alpha, \lambda, \rho)$ 是幺半范畴，其中 $\otimes$ 是张量积。

## 7.0 闭范畴

### 7.1 闭范畴定义

**定义 7.1.1 (闭范畴)**
闭范畴是幺半范畴 $(\mathcal{C}, \otimes, I)$，其中对于每个对象 $A$，函子 $(-) \otimes A$ 有右伴随 $[A, -]$。

**定义 7.1.2 (内部Hom)**
内部Hom函子 $[A, B]$ 满足：
$$\text{Mor}_{\mathcal{C}}(C \otimes A, B) \cong \text{Mor}_{\mathcal{C}}(C, [A, B])$$

### 7.2 闭范畴例子

**定义 7.2.1 (集合闭范畴)**
$\mathbf{Set}$ 是闭范畴，其中 $[A, B] = B^A$（函数集合）。

**定义 7.2.2 (向量空间闭范畴)**
$\mathbf{Vect}_k$ 是闭范畴，其中 $[V, W] = \text{Hom}_k(V, W)$（线性映射空间）。

### 7.3 闭范畴性质

**定理 7.3.1 (Curry同构)**
在闭范畴中，有自然同构：
$$[A \otimes B, C] \cong [A, [B, C]]$$

## 8.0 软件范畴

### 8.1 软件组件范畴

**定义 8.1.1 (软件组件)**
软件组件是一个五元组 $C = (I, O, S, B, Q)$，其中：

- $I$ 是输入接口集合
- $O$ 是输出接口集合
- $S$ 是状态集合
- $B$ 是行为集合
- $Q$ 是质量属性集合

**定义 8.1.2 (组件态射)**
组件态射 $f: C_1 \to C_2$ 是一个三元组 $(f_I, f_O, f_S)$，其中：

- $f_I: I_2 \to I_1$ 是输入接口映射
- $f_O: O_1 \to O_2$ 是输出接口映射
- $f_S: S_1 \to S_2$ 是状态映射

**定义 8.1.3 (软件范畴)**
软件范畴 $\mathbf{Comp}$：
- 对象：软件组件
- 态射：组件态射
- 复合：态射复合
- 恒等：恒等态射

### 8.2 组件组合

**定义 8.2.1 (串行组合)**
组件 $C_1$ 和 $C_2$ 的串行组合 $C_1 \circ C_2$：
- 输入：$C_1$ 的输入
- 输出：$C_2$ 的输出
- 状态：$S_1 \times S_2$
- 行为：组合行为

**定义 8.2.2 (并行组合)**
组件 $C_1$ 和 $C_2$ 的并行组合 $C_1 \parallel C_2$：
- 输入：$I_1 \times I_2$
- 输出：$O_1 \times O_2$
- 状态：$S_1 \times S_2$
- 行为：并行行为

### 8.3 软件架构范畴

**定义 8.3.1 (软件架构)**
软件架构是一个三元组 $A = (C, L, P)$，其中：

- $C$ 是组件集合
- $L$ 是连接器集合
- $P$ 是配置集合

**定义 8.3.2 (架构态射)**
架构态射 $f: A_1 \to A_2$ 包含：
- 组件映射：$f_C: C_1 \to C_2$
- 连接器映射：$f_L: L_1 \to L_2$
- 配置映射：$f_P: P_1 \to P_2$

## 9.0 计算范畴

### 9.1 计算模型

**定义 9.1.1 (计算范畴)**
计算范畴 $\mathbf{Comp}$：
- 对象：计算模型
- 态射：计算变换
- 复合：变换复合
- 恒等：恒等变换

**定义 9.1.2 (图灵机范畴)**
图灵机范畴 $\mathbf{TM}$：
- 对象：图灵机
- 态射：图灵机变换
- 复合：变换复合
- 恒等：恒等变换

### 9.2 Lambda演算范畴

**定义 9.2.1 (Lambda演算)**
Lambda演算的项：
1. 变量 $x$ 是项
2. 如果 $M$ 是项，则 $\lambda x.M$ 是项
3. 如果 $M, N$ 是项，则 $(M N)$ 是项

**定义 9.2.2 (Beta归约)**
Beta归约规则：
$$(\lambda x.M) N \to M[N/x]$$

**定义 9.2.3 (Lambda范畴)**
Lambda范畴 $\mathbf{Lambda}$：
- 对象：类型
- 态射：Lambda项
- 复合：函数复合
- 恒等：恒等函数

### 9.3 类型理论范畴

**定义 9.3.1 (类型理论)**
类型理论包含：
- 类型构造子
- 项构造子
- 归约规则
- 类型检查规则

**定义 9.3.2 (类型范畴)**
类型范畴 $\mathbf{Type}$：
- 对象：类型
- 态射：类型函数
- 复合：函数复合
- 恒等：恒等函数

## 10.0 形式化证明

### 10.1 范畴公理证明

**定理 10.1.1 (结合律)**
在任意范畴中，态射复合满足结合律：
$$(f \circ g) \circ h = f \circ (g \circ h)$$

**证明**：
根据范畴公理，态射复合满足结合律。

### 10.2 函子性质证明

**定理 10.2.1 (函子保持恒等)**
对于任意函子 $F: \mathcal{C} \to \mathcal{D}$ 和对象 $A \in \text{Ob}(\mathcal{C})$：
$$F(\text{id}_A) = \text{id}_{F(A)}$$

**证明**：
根据函子定义，$F(\text{id}_A) = \text{id}_{F(A)}$。

### 10.3 伴随唯一性证明

**定理 10.3.1 (伴随唯一性)**
如果 $F \dashv G$ 和 $F \dashv G'$，则 $G \cong G'$。

**证明**：
使用伴随的余单位构造自然同构 $G \cong G'$。

## 总结

本文建立了范畴论的形式化理论体系，包括：

1. **基本概念**：范畴定义、公理、例子
2. **函子理论**：协变函子、反变函子、函子性质
3. **自然变换**：自然变换定义、函子范畴
4. **极限理论**：极限、余极限、特殊极限
5. **伴随理论**：伴随函子、单位余单位
6. **幺半范畴**：幺半范畴、幺半函子
7. **闭范畴**：闭范畴、内部Hom
8. **应用理论**：软件范畴、计算范畴

该理论体系为软件架构的形式化分析提供了统一的数学框架。
