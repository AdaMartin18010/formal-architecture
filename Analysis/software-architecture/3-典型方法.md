# 软件架构 · 典型方法

## 3.1 架构设计方法

- 需求到战术：从质量属性场景（QAS）推导策略（缓存、异步、重试、幂等、熔断）。
- 领域驱动设计（DDD）：领域模型、限界上下文、上下文映射，保证边界清晰与耦合可控。
- 契约优先：API/事件契约先行，驱动服务自治与版本治理。
- 架构决策记录（ADR）：记录关键决策与权衡，支持回溯与演进。

## 3.2 评估与权衡

- ATAM/CBAM：以场景驱动评估架构在不同质量属性下的表现与成本收益。
- 负载建模：峰值/日常流量、读写比、P50/P95/P99 延迟预算。
- 混沌工程：容错与恢复演练，验证降级、熔断、重试的有效性。
- 可观测性：指标、日志、追踪三板斧，SLO/SLI/错误预算。

## 3.3 非功能性评测清单（示例）

- 可靠性：可用性≥99.9%，故障转移≤30s，RTO/RPO 约束。
- 性能：P95 延迟<200ms，P99<500ms，吞吐≥目标 QPS×峰值系数。
- 伸缩：自动扩缩容响应<2min，容量上限≥峰值×2。
- 安全：鉴权覆盖率100%，敏感数据加密在传输与存储两端到端。
- 可维护性：变更 lead time≤1 天，回滚≤10 分钟，变更失败率<15%。
- 可观测性：核心 SLI 全覆盖，告警噪声比<5%，追踪采样覆盖≥10%。

## 3.4 样例 SLO（模板）

- 可用性：月度≥99.9%（错误预算≤43.2 分钟）。
- 延迟：读接口 P95<150ms、P99<300ms；写接口 P95<300ms、P99<800ms。
- 错误率：5xx 比例<0.1%，超时比例<0.2%。
- 队列：平均滞留<1s，P95<5s；死信率<0.01%。
