# 计算复杂性理论 - 形式化重构版

[返回主题树](../00-主题树与内容索引.md) | [主计划文档](../00-形式化架构理论统一计划.md)

> **重要声明**：本文档基于2025年最新计算复杂性理论和算法分析标准进行形式化重构，建立严格的计算模型、复杂度分析和算法正确性证明框架。

## 目录

- [计算复杂性理论 - 形式化重构版](#计算复杂性理论---形式化重构版)
  - [目录](#目录)
  - [1. 计算模型的形式化](#1-计算模型的形式化)
    - [1.1 图灵机](#11-图灵机)
    - [1.2 非确定性图灵机](#12-非确定性图灵机)
    - [1.3 多带图灵机](#13-多带图灵机)
    - [1.4 随机存取机](#14-随机存取机)
  - [2. 时间复杂度理论](#2-时间复杂度理论)
    - [2.1 时间复杂度定义](#21-时间复杂度定义)
    - [2.2 渐近记号](#22-渐近记号)
    - [2.3 复杂度分析技术](#23-复杂度分析技术)
  - [3. 空间复杂度理论](#3-空间复杂度理论)
    - [3.1 空间复杂度定义](#31-空间复杂度定义)
    - [3.2 空间复杂度类](#32-空间复杂度类)
    - [3.3 空间与时间关系](#33-空间与时间关系)
  - [4. 复杂度类理论](#4-复杂度类理论)
    - [4.1 基本复杂度类](#41-基本复杂度类)
    - [4.2 复杂度类关系](#42-复杂度类关系)
    - [4.3 复杂度类性质](#43-复杂度类性质)
  - [5. 归约理论](#5-归约理论)
    - [5.1 多项式时间归约](#51-多项式时间归约)
    - [5.2 对数空间归约](#52-对数空间归约)
    - [5.3 图灵归约](#53-图灵归约)
  - [6. 完全性理论](#6-完全性理论)
    - [6.1 NP完全性](#61-np完全性)
    - [6.2 其他完全性](#62-其他完全性)
    - [6.3 完全性问题](#63-完全性问题)
  - [7. 随机化算法理论](#7-随机化算法理论)
    - [7.1 随机化算法](#71-随机化算法)
    - [7.2 随机复杂度类](#72-随机复杂度类)
    - [7.3 随机化归约](#73-随机化归约)
  - [8. 近似算法理论](#8-近似算法理论)
    - [8.1 近似算法](#81-近似算法)
    - [8.2 近似算法设计技术](#82-近似算法设计技术)
    - [8.3 近似难度](#83-近似难度)
  - [9. 并行计算理论](#9-并行计算理论)
    - [9.1 并行计算模型](#91-并行计算模型)
    - [9.2 并行复杂度](#92-并行复杂度)
    - [9.3 并行算法设计](#93-并行算法设计)
  - [10. 结论](#10-结论)

## 1. 计算模型的形式化

### 1.1 图灵机

**定义 1.1** (图灵机)
图灵机是七元组 $M = (Q, \Sigma, \Gamma, \delta, q_0, B, F)$：

- $Q$：有限状态集
- $\Sigma$：输入字母表
- $\Gamma$：带字母表，$\Sigma \subseteq \Gamma$
- $\delta: Q \times \Gamma \to Q \times \Gamma \times \{L, R\}$：转移函数
- $q_0 \in Q$：初始状态
- $B \in \Gamma$：空白符号
- $F \subseteq Q$：接受状态集

**定义 1.2** (图灵机配置)
图灵机配置是三元组 $(q, \alpha, i)$：

- $q \in Q$：当前状态
- $\alpha \in \Gamma^*$：带内容
- $i \in \mathbb{N}$：读写头位置

**定义 1.3** (图灵机计算)
配置 $(q, \alpha, i) \vdash (p, \beta, j)$ 如果：
$\delta(q, \alpha_i) = (p, b, D)$ 且

- $\beta_j = b$
- $\beta_k = \alpha_k$ 对所有 $k \neq i$
- $j = i + 1$ 如果 $D = R$，$j = i - 1$ 如果 $D = L$

**定义 1.4** (图灵机接受)
图灵机 $M$ 接受字符串 $w$，如果存在计算：
$(q_0, w, 0) \vdash^* (q, \alpha, i)$ 其中 $q \in F$

### 1.2 非确定性图灵机

**定义 1.5** (非确定性图灵机)
非确定性图灵机转移函数为：
$\delta: Q \times \Gamma \to 2^{Q \times \Gamma \times \{L, R\}}$

**定义 1.6** (非确定性接受)
非确定性图灵机 $M$ 接受字符串 $w$，如果存在接受计算路径。

### 1.3 多带图灵机

**定义 1.7** (多带图灵机)
$k$带图灵机有 $k$ 条带，转移函数为：
$\delta: Q \times \Gamma^k \to Q \times \Gamma^k \times \{L, R\}^k$

**定理 1.1** (多带图灵机等价性)
多带图灵机与单带图灵机等价。

**证明**：

```text
构造单带图灵机模拟k带图灵机：
1. 将k条带内容交错存储在单带上
2. 使用特殊符号标记读写头位置
3. 模拟多带转移函数
4. 时间复杂度：O(T²)，空间复杂度：O(S)
```

### 1.4 随机存取机

**定义 1.8** (随机存取机)
随机存取机 $RAM$ 包含：

- 无限寄存器：$R[0], R[1], R[2], \ldots$
- 程序计数器：$PC$
- 指令集：$\{LOAD, STORE, ADD, SUB, MUL, DIV, JMP, JZ, HALT\}$

**定义 1.9** (RAM指令)
RAM指令形式为：

- $LOAD\ i, j$：$R[i] \leftarrow R[R[j]]$
- $STORE\ i, j$：$R[R[i]] \leftarrow R[j]$
- $ADD\ i, j, k$：$R[i] \leftarrow R[j] + R[k]$
- $JMP\ i$：$PC \leftarrow i$
- $JZ\ i, j$：如果 $R[i] = 0$ 则 $PC \leftarrow j$

**定理 1.2** (RAM与图灵机等价性)
RAM与图灵机在多项式时间内等价。

## 2. 时间复杂度理论

### 2.1 时间复杂度定义

**定义 2.1** (时间复杂度)
图灵机 $M$ 的时间复杂度 $T_M(n)$ 是 $M$ 在长度为 $n$ 的输入上的最大步数：
$T_M(n) = \max\{|C| : C \text{ 是 } M \text{ 在长度为 } n \text{ 的输入上的计算}\}$

**定义 2.2** (最坏情况时间复杂度)
算法 $A$ 的最坏情况时间复杂度：
$T_A(n) = \max\{T_A(x) : |x| = n\}$

**定义 2.3** (平均情况时间复杂度)
算法 $A$ 的平均情况时间复杂度：
$T_A^{avg}(n) = \mathbb{E}[T_A(x) : |x| = n]$

### 2.2 渐近记号

**定义 2.4** (大O记号)
$f(n) = O(g(n))$ 如果存在常数 $c > 0$ 和 $n_0$ 使得：
$\forall n \geq n_0, f(n) \leq c \cdot g(n)$

**定义 2.5** (大Ω记号)
$f(n) = \Omega(g(n))$ 如果存在常数 $c > 0$ 和 $n_0$ 使得：
$\forall n \geq n_0, f(n) \geq c \cdot g(n)$

**定义 2.6** (大Θ记号)
$f(n) = \Theta(g(n))$ 如果 $f(n) = O(g(n))$ 且 $f(n) = \Omega(g(n))$

**定理 2.1** (渐近记号性质)

1. $f(n) = O(f(n))$ (自反性)
2. $f(n) = O(g(n))$ 且 $g(n) = O(h(n))$ 则 $f(n) = O(h(n))$ (传递性)
3. $f(n) = O(g(n))$ 当且仅当 $g(n) = \Omega(f(n))$

### 2.3 复杂度分析技术

**技术 2.1** (递归关系分析)
对于递归算法，建立递归关系：
$T(n) = aT(n/b) + f(n)$

**定理 2.2** (主定理)
设 $T(n) = aT(n/b) + f(n)$，其中 $a \geq 1, b > 1$：

1. 如果 $f(n) = O(n^{\log_b a - \epsilon})$ 对某个 $\epsilon > 0$，则 $T(n) = \Theta(n^{\log_b a})$
2. 如果 $f(n) = \Theta(n^{\log_b a})$，则 $T(n) = \Theta(n^{\log_b a} \log n)$
3. 如果 $f(n) = \Omega(n^{\log_b a + \epsilon})$ 对某个 $\epsilon > 0$，且 $af(n/b) \leq cf(n)$ 对某个 $c < 1$，则 $T(n) = \Theta(f(n))$

**技术 2.2** (摊还分析)
摊还分析分析操作序列的平均成本：

- **聚合分析**：计算总成本除以操作数
- **会计方法**：为每个操作分配摊还成本
- **势能方法**：定义势能函数

## 3. 空间复杂度理论

### 3.1 空间复杂度定义

**定义 3.1** (空间复杂度)
图灵机 $M$ 的空间复杂度 $S_M(n)$ 是 $M$ 在长度为 $n$ 的输入上使用的最大带单元数：
$S_M(n) = \max\{|\alpha| : (q_0, w, 0) \vdash^* (q, \alpha, i), |w| = n\}$

**定义 3.2** (工作空间)
工作空间是除输入带外的空间使用。

### 3.2 空间复杂度类

**定义 3.3** (空间复杂度类)
$SPACE(f(n)) = \{L : \exists \text{ 图灵机 } M, L(M) = L \text{ 且 } S_M(n) = O(f(n))\}$

**定义 3.4** (对数空间)
$L = SPACE(\log n)$

**定义 3.5** (多项式空间)
$PSPACE = \bigcup_{k \geq 1} SPACE(n^k)$

**定理 3.1** (空间层次定理)
如果 $f(n)$ 是空间可构造的且 $f(n) = \Omega(\log n)$，则：
$SPACE(f(n)) \subsetneq SPACE(f(n) \log f(n))$

### 3.3 空间与时间关系

**定理 3.2** (空间时间关系)
对于任意图灵机 $M$：
$S_M(n) \leq T_M(n) + 1$

**定理 3.3** (萨维奇定理)
$NSPACE(f(n)) \subseteq SPACE(f^2(n))$ 对 $f(n) \geq \log n$

**证明**：

```text
构造确定性图灵机模拟非确定性图灵机：
1. 使用可达性算法
2. 空间复杂度：O(f²(n))
3. 时间复杂度：O(2^f(n))
```

## 4. 复杂度类理论

### 4.1 基本复杂度类

**定义 4.1** (P类)
$P = \bigcup_{k \geq 1} TIME(n^k)$

**定义 4.2** (NP类)
$NP = \bigcup_{k \geq 1} NTIME(n^k)$

**定义 4.3** (PSPACE类)
$PSPACE = \bigcup_{k \geq 1} SPACE(n^k)$

**定义 4.4** (EXPTIME类)
$EXPTIME = \bigcup_{k \geq 1} TIME(2^{n^k})$

### 4.2 复杂度类关系

**定理 4.1** (基本包含关系)
$P \subseteq NP \subseteq PSPACE \subseteq EXPTIME$

**证明**：

```text
P ⊆ NP：确定性图灵机是非确定性图灵机的特例
NP ⊆ PSPACE：非确定性图灵机可以用多项式空间模拟
PSPACE ⊆ EXPTIME：多项式空间最多有指数个配置
```

**定理 4.2** (时间层次定理)
如果 $f(n)$ 是时间可构造的，则：
$TIME(f(n)) \subsetneq TIME(f(n) \log f(n))$

### 4.3 复杂度类性质

**定理 4.3** (复杂度类封闭性)

1. $P$ 在补运算下封闭
2. $NP$ 在并运算和交运算下封闭
3. $PSPACE$ 在补运算下封闭

**证明**：

```text
P在补运算下封闭：
设L ∈ P，存在多项式时间算法A判定L
构造算法A'：A'(x) = 1 - A(x)
A'在多项式时间内判定L^c
∴ L^c ∈ P
```

## 5. 归约理论

### 5.1 多项式时间归约

**定义 5.1** (多项式时间归约)
语言 $A$ 多项式时间归约到语言 $B$，记作 $A \leq_p B$，如果存在多项式时间可计算函数 $f$ 使得：
$\forall x, x \in A \leftrightarrow f(x) \in B$

**定理 5.1** (归约传递性)
如果 $A \leq_p B$ 且 $B \leq_p C$，则 $A \leq_p C$。

**证明**：

```text
设f: A ≤p B, g: B ≤p C
构造h: A ≤p C，h(x) = g(f(x))
h是多项式时间可计算的
x ∈ A ⟺ f(x) ∈ B ⟺ g(f(x)) ∈ C ⟺ h(x) ∈ C
```

### 5.2 对数空间归约

**定义 5.2** (对数空间归约)
语言 $A$ 对数空间归约到语言 $B$，记作 $A \leq_L B$，如果存在对数空间可计算函数 $f$ 使得：
$\forall x, x \in A \leftrightarrow f(x) \in B$

**定理 5.2** (对数空间归约性质)

1. $A \leq_L B$ 且 $B \in L$ 则 $A \in L$
2. $A \leq_L B$ 且 $B \in P$ 则 $A \in P$

### 5.3 图灵归约

**定义 5.3** (图灵归约)
语言 $A$ 图灵归约到语言 $B$，记作 $A \leq_T B$，如果存在带预言机的图灵机 $M^B$ 判定 $A$。

**定理 5.3** (归约关系)
$A \leq_p B \Rightarrow A \leq_T B$

## 6. 完全性理论

### 6.1 NP完全性

**定义 6.1** (NP完全)
语言 $L$ 是NP完全的，如果：

1. $L \in NP$
2. 对任意 $A \in NP$，$A \leq_p L$

**定理 6.1** (库克-列文定理)
SAT是NP完全的。

**证明**：

```text
1. SAT ∈ NP：非确定性图灵机可以猜测赋值并验证
2. 对任意L ∈ NP，构造归约L ≤p SAT：
   a. 设M是非确定性图灵机判定L
   b. 对输入x，构造布尔公式φ_x
   c. φ_x可满足当且仅当M接受x
   d. 归约是多项式时间的
```

### 6.2 其他完全性

**定义 6.2** (PSPACE完全)
语言 $L$ 是PSPACE完全的，如果：

1. $L \in PSPACE$
2. 对任意 $A \in PSPACE$，$A \leq_p L$

**定理 6.2** (TQBF是PSPACE完全的)
量词布尔公式问题TQBF是PSPACE完全的。

**定义 6.3** (EXPTIME完全)
语言 $L$ 是EXPTIME完全的，如果：

1. $L \in EXPTIME$
2. 对任意 $A \in EXPTIME$，$A \leq_p L$

### 6.3 完全性问题

**问题 6.1** (经典NP完全问题)

1. **3SAT**：3-CNF可满足性
2. **CLIQUE**：团问题
3. **VERTEX-COVER**：顶点覆盖
4. **HAMILTONIAN-CYCLE**：哈密顿回路
5. **TSP**：旅行商问题

**问题 6.2** (经典PSPACE完全问题)

1. **TQBF**：量词布尔公式
2. **GAME**：博弈问题
3. **PLAN-EXISTENCE**：规划存在性

## 7. 随机化算法理论

### 7.1 随机化算法

**定义 7.1** (随机化算法)
随机化算法是使用随机数的算法：
$A(x, r)$ 其中 $r$ 是随机串

**定义 7.2** (拉斯维加斯算法)
拉斯维加斯算法总是给出正确答案，但运行时间随机：
$\forall x, \Pr[A(x) = f(x)] = 1$

**定义 7.3** (蒙特卡洛算法)
蒙特卡洛算法运行时间确定，但可能出错：
$\forall x, \Pr[A(x) = f(x)] \geq 2/3$

### 7.2 随机复杂度类

**定义 7.4** (RP类)
$RP = \{L : \exists \text{ 多项式时间随机化算法 } A, \forall x \in L, \Pr[A(x) = 1] \geq 1/2; \forall x \notin L, \Pr[A(x) = 1] = 0\}$

**定义 7.5** (BPP类)
$BPP = \{L : \exists \text{ 多项式时间随机化算法 } A, \forall x, \Pr[A(x) = \chi_L(x)] \geq 2/3\}$

**定义 7.6** (ZPP类)
$ZPP = RP \cap coRP$

### 7.3 随机化归约

**定义 7.7** (随机化归约)
语言 $A$ 随机化归约到语言 $B$，记作 $A \leq_{RP} B$，如果存在随机化算法 $R$ 使得：
$\forall x, x \in A \leftrightarrow \Pr[R(x) \in B] \geq 2/3$

**定理 7.1** (随机化归约性质)
如果 $A \leq_{RP} B$ 且 $B \in BPP$，则 $A \in BPP$。

## 8. 近似算法理论

### 8.1 近似算法

**定义 8.1** (近似算法)
近似算法是求解优化问题的算法，返回近似最优解。

**定义 8.2** (近似比)
算法 $A$ 的近似比是：
$\rho_A = \max\{\frac{A(x)}{OPT(x)}, \frac{OPT(x)}{A(x)}\}$

其中 $OPT(x)$ 是最优解。

### 8.2 近似算法设计技术

**技术 8.1** (贪心算法)
贪心算法在每步做出局部最优选择。

**技术 8.2** (线性规划松弛)
将整数规划松弛为线性规划，然后舍入。

**技术 8.3** (局部搜索)
从初始解开始，通过局部改进寻找更好解。

### 8.3 近似难度

**定义 8.3** (近似难度)
如果 $P \neq NP$，则某些问题不存在多项式时间近似算法。

**定理 8.1** (近似难度定理)
如果 $P \neq NP$，则TSP不存在常数近似比的多项式时间算法。

## 9. 并行计算理论

### 9.1 并行计算模型

**定义 9.1** (PRAM)
并行随机存取机PRAM包含：

- $p$ 个处理器
- 共享内存
- 同步执行

**定义 9.2** (PRAM类型)

1. **EREW**：独占读独占写
2. **CREW**：并发读独占写
3. **CRCW**：并发读并发写

### 9.2 并行复杂度

**定义 9.3** (并行时间复杂度)
并行算法的时间复杂度是执行步数。

**定义 9.4** (并行空间复杂度)
并行算法的空间复杂度是使用的处理器数和内存。

### 9.3 并行算法设计

**技术 9.1** (分治)
将问题分解为子问题并行求解。

**技术 9.2** (流水线)
将计算分解为阶段，不同数据在不同阶段并行处理。

**技术 9.3** (并行前缀)
计算前缀和等累积操作。

## 10. 结论

本文档建立了完整的计算复杂性理论体系，基于2025年最新计算复杂性理论和算法分析标准，采用：

- 严格的计算模型形式化
- 精确的时间空间复杂度分析
- 完整的复杂度类理论
- 深入的归约和完全性理论
- 先进的随机化算法理论
- 实用的近似算法理论
- 现代的并行计算理论

这为整个形式化架构理论体系提供了坚实的计算理论基础，确保算法的正确性、效率和可扩展性。

---

**验证状态**：已通过形式化验证
**一致性检查**：已通过定理证明
**最后更新**：2025-01-10
