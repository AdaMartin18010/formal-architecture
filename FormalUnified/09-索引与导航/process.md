# 索引与导航推进进程

## 当前阶段：知识体系导航构建

### 已完成工作

1. ✅ 基础目录结构建立
2. ✅ 主题索引框架设计
3. ✅ 各理论体系内部导航

### 进行中工作

1. 🔄 统一导航系统设计（进度：45%）
   - 产出：信息架构草案 v0.3，核心实体与关系字典（补充别名/同义）
2. 🔄 知识图谱可视化工具开发（进度：35%）
   - 产出：MVP 交互原型，节点/边样式方案（新增布局切换与过滤）
3. 🔄 跨主题关系映射（进度：35%）
   - 产出：样例集 v0.2（≥20 组），一致性校验规则草案

### 本周进展摘要

- 完成“层次化浏览”路径与面包屑交互草测，修复 3 个可用性问题
- 产出混合检索基线配置 v0.1，并跑通小规模评测集
- 扩充跨主题映射样例至 22 组，初步建立冲突检测脚本
- 新建 /Analysis 目录首批内容：分类模板、范畴理论主题骨架、全局索引

### 下周计划（滚动）

- 完成“层次化浏览”模块的导航路径与面包屑实现验收
- 输出“实时搜索”混合检索策略评测对比与配置建议
- 扩充跨主题映射样例至 ≥ 20 组并完成一次评审

### 待推进工作

1. ⏳ 智能检索系统
2. ⏳ 语义导航引擎
3. ⏳ 交互式知识图谱
4. ⏳ 个性化学习路径

## 推进计划

### 阶段1：索引体系完善（当前）

- 建立完整的主题索引
- 创建跨领域关系图
- 设计统一的标签系统

### 阶段2：导航工具开发

- 实现智能搜索功能
- 开发可视化导航界面
- 构建语义关系网络

### 阶段3：用户体验优化

- 个性化推荐系统
- 自适应学习路径
- 交互式探索工具

### 阶段4：智能化升级

- AI驱动的知识发现
- 自动关系识别
- 智能内容组织

## 短期行动清单（滚动更新）

- [ ] 收敛统一导航信息架构（IA）草案并组织评审
- [ ] 梳理跨主题关系映射的最小闭环样例集（≥10 个）
- [ ] 规划知识图谱可视化的 MVP 交互与数据接口
- [ ] 明确智能检索系统的核心查询语义与评测集
- [ ] 建立标签体系与主题索引的映射规则库

## 里程碑与时间表

- M1（T+2 周）：索引体系完善达标（覆盖率 ≥ 98%）
- M2（T+4 周）：导航工具 MVP 可用（检索/浏览闭环）
- M3（T+8 周）：语义导航与个性化路径首版

## 风险与依赖

- 数据源规范统一与元数据质量保障
- 跨主题映射的一致性与可解释性
- 性能预算：响应时间 < 200ms 与图渲染复杂度平衡
- 工具链依赖（Neo4j/FAISS/Milvus）的部署与资源配额

## 技术架构

### 索引技术栈

- 全文检索：Elasticsearch/Lucene
- 图数据库：Neo4j/TigerGraph
- 向量搜索：FAISS/Milvus
- 可视化：D3.js/Cytoscape

### 导航功能

- [ ] 层次化浏览
  - 验收：支持 3 层以上层级折叠/展开；路径面包屑可用；节点跳转 ≤ 2 次到达任意主题
  - 追踪指标：跳出率、层级导航完成率
- [ ] 关联推荐
  - 验收：基于语义与引用关系的 Top-N 推荐；可解释性标签展示
  - 追踪指标：推荐点击率（CTR）、后续停留时长
- [ ] 路径优化
  - 验收：从 A 到 B 的最短/最相关学习路径生成；支持多约束（难度/时长）
  - 追踪指标：路径完成率、用户满意度
- [ ] 实时搜索
  - 验收：响应时间 P95 < 200ms；支持布尔、短语、向量混合检索
  - 追踪指标：检索准确率@K、查询成功率

## 语义导航引擎：图模型与路径代价函数

- 图模型：
  - 节点：主题、概念、方法、案例、定理/命题、引用源
  - 边：先修(prerequisite)、依赖(depends_on)、引用(cites)、相似(similar_to)、同义(alias_of)
  - 权重：依据难度、相关性、先修强度、知识新鲜度、可信度
- 路径代价函数：
  - 目标：在满足先修约束下，最小化综合代价
  - 代价定义：
    - cost(path) = Σ_edge [ w_rel·(1-sim) + w_prq·prereq_penalty + w_dif·difficulty + w_len·step_cost ]
    - 约束：∀节点需满足先修覆盖度 ≥ τ_prq；路径长度 ≤ L_max
  - 求解：
    - 基线：Dijkstra/A*（启发式由语义相似度提供）
    - 变体：多目标最短路（Pareto 前沿），带硬约束的 A*（不可达剪枝）
  - 评测：
    - 指标：路径可行率、完成率、平均代价、用户满意度
    - 协议：专家标注的参考路径与用户交互反馈对比

## Analysis 目录对齐与迁移计划

- 目标：将 `FormalUnified` 下内容按主题抽取、归并、去重，持续输出到 `/Analysis`
- 步骤：
  1) 主题清单与映射表（源路径→/Analysis/主题路径）
  2) 去重与别名规范（同义合并、引用指向唯一锚点）
  3) 结构重写：按模板生成主题首页与子章节骨架
  4) 本地互链：相互引用使用相对路径与锚点
  5) 校验：链接完整性、编号连续性、Lint 与 CI 校验

## 本地引用与编号规范

- 文件内编号：采用 1.、1.1、1.1.1 的层级序号，标题与段落保持一致
- 交叉引用：
  - 文内：使用标准 Markdown 锚点（中文标题转小写、空格转-）
  - 跨文件：使用相对路径与锚点，如 `../Analysis/topic-a.md#1-定义`
- 图表编号：图 n-序号、表 n-序号，随章节递增
- 证明与定理：使用“定理 n. m”“引理 n. m. k”与引用回指

## 智能检索系统：查询 DSL 与混合检索策略

示例查询 DSL（YAML）：

```yaml
query: "范畴理论 极限 与 余极限"
filters:
  difficulty: [beginner, intermediate]
  type: [concept, example]
operators:
  must: ["极限", "范畴"]
  should: ["余极限", "图示"]
  phrase: ["通用性质"]
retrieval:
  hybrid:
    bm25_weight: 0.5
    vector_weight: 0.5
    rerank: cross-encoder-msmarco-MiniLM-L6-v2
top_k: 10
```

混合检索策略建议：

- 候选召回：BM25@200 + 向量召回@200，合并去重后重排
- 重排层：交叉编码器重排@200→输出@50，再基于导航上下文二次重排@10
- 领域短语词典：维护领域专名、别名、缩写映射以增强 BM25 召回

## 数据同步与索引策略

- 索引结构：
  - 主索引（文档/概念/主题），子索引（引用/关系），别名索引（线上切换）
- 同步机制：
  - 增量：基于变更日志流（CDC）实时更新 ES/图库/向量库
  - 全量：夜间重建与一致性校验，失败自动回滚至上一个快照
- 向量生成：
  - 批量异步；热文档优先队列；版本化嵌入并保留 N-1 版本

## 可观测性与报警

- 指标：QPS、P50/P95/P99 延迟、错误率、命中率、缓存命中、GC 时间
- 检索质量看板：nDCG@K、mAP@K、查询成功率、零结果率
- 报警规则：
  - 延迟 P95 > 200ms（5 分钟）
  - 零结果率较基线升高 > 3pp（15 分钟）
  - nDCG@10 较上周下降 > 5%（日级）

## 发布与回滚流程

1. 预发环境回归：通过离线评测基线与合成流量压测
2. 影子发布：1% 流量观测 30 分钟，关键指标不退化
3. 渐进放量：1%→5%→20%→50%→100%
4. 回滚准则：任一红线触发即回滚至上一个稳定别名/快照

## 角色与职责（RACI）

- IA 设计：R（信息架构师），A（产品负责人），C（领域专家），I（研发）
- 检索策略：R（算法工程师），A（搜索负责人），C（数据标注），I（前端）
- 可视化导航：R（前端工程师），A（前端负责人），C（设计师），I（产品）

## 变更日志

- 2025-08-22：新增 DSL、混合检索策略、同步/索引、可观测性、发布与回滚、RACI、变更日志；更新进行中进度与周报

## 评测基线与数据集

- 基线集合：
  - 检索准确率：BM25 基线、E5-Base 向量检索、Hybrid（BM25+向量）
  - 语义导航：基于图最短路 vs 语义加权路由
  - 个性化：协同过滤 vs 语义偏好重排
- 数据集与样例：
  - 查询集：100 条人工标注查询（导航、事实、探索各约 1/3）
  - 相关性标注：3 档相关度（强/中/弱），每条 ≥ 3 人复核
  - 路径任务：20 对起点-终点及约束（难度、时长）

## 关键指标

- 检索准确率 > 95%
- 响应时间 < 200ms
- 覆盖率 > 98%
- 用户满意度 > 4.5/5

### 评测方法与统计口径

- 检索准确率：
  - 定义：Top-K（K=10）相关性@K；报告 mAP@10 与 nDCG@10
  - 口径：去重后按查询类型（导航/事实/探索）分层统计，样本量≥100
- 响应时间：
  - 定义：服务端响应时间 P95；另报告 P50/P99 作为参考
  - 口径：生产等同数据量下压测；冷/热缓存分开统计
- 覆盖率：
  - 定义：可导航节点覆盖率 = 实际可导航节点数 / 应有节点数
  - 口径：以主题/概念为最小可导航单元，排除存档与隐藏节点
- 用户满意度：
  - 定义：内嵌评分（五星）与问卷的加权平均
  - 口径：活跃用户样本≥50；结果给出均值与95%置信区间
- 回归与频率：
  - 周期：每周基准评测；阈值回落>5%触发报警与回滚评审

## 统一导航系统设计（IA）草案目录模板

1. 设计目标与范围（问题定义、成功标准）
2. 核心实体与关系字典（主题、概念、理论、方法、案例、引用、先修、依赖等）
3. 分层结构与命名规则（深度、广度、别名/同义）
4. 标签体系与映射规则（主题↔标签、规则优先级、冲突处理）
5. 导航模式与交互（层次化浏览、面包屑、路径规划、关联推荐）
6. 检索语义与查询 DSL（布尔/短语/向量/混合策略）
7. 数据模型与存储（ES 索引结构、图模型、向量库、同步机制）
8. 性能与容量规划（QPS、延迟预算、索引规模、缓存策略）
9. 治理与版本（变更流程、标注规范、审核与回溯）
10. 度量与验收标准（与“关键指标”一致的验收清单）

---
*最后更新：2025年08月*-
